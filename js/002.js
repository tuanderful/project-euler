// Even Fibonacci numbers
// Problem 2
// Each new term in the Fibonacci sequence is generated by adding the previous
// two terms. By starting with 1 and 2, the first 10 terms will be:

// 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...

// By considering the terms in the Fibonacci sequence whose values do not exceed
// four million, find the sum of the even-valued terms.

// Answer:
// 4613732


function TIMER(resolution) {
  var resIndex = resolution == 'ns' ? 1 : 0;

  if (process && process.hrtime) {
    this.start = function() {
      this.startTimes = process.hrtime();
    }
    this.end = function() {
      var processingTime =  process.hrtime(this.startTimes);

      console.log(processingTime[resIndex]);
    }
  }
}

// var timer = new TIMER('ns');
// timer.start();

// setTimeout(function(){
//   timer.end();
// }, 2000);



/**
 * fibonacci
 * Return the nth number of the fibonacci sequence
 */

var fibmemo = [0, 1];

function fibonacci(n) {
  if (fibmemo[n] !== undefined) {
    return fibmemo[n];
  }
  else {
    return fibonacci(n-1) + fibonacci(n-2);
  }
}

(function sumEvenFib(limit) {
  var sum = 0,
      i = 0,
      thisFib = fibonacci(i),
      timer = new TIMER();
  
  timer.start();


  while(thisFib <= limit) {
    //if (thisFib % 2 == 0) {
    if ((thisFib & 1) == 0) {
      sum += thisFib;
    }

    //i++;
    thisFib = fibonacci(++i);
  }

  timer.end();

  console.log(sum);

})(4000000);



